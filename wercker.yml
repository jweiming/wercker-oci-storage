build:
  box: ubuntu
  steps:
    - script:
      name: Set API_KEY file
      code:  |
         export API=$OCI_API_KEY
         export API_KEY=($API | tr ' ' '\n')
         echo $API_KEY
         echo -ne "-----BEGIN RSA PRIVATE KEY-----\n$API_KEY\n-----END RSA PRIVATE KEY-----" > api-key.pem
    - wercker/oci-objectstore@1.2.0:
      region:       $OCI_REGION
      tenancy-ocid: $OCID_TENANCY
      user-ocid:    $OCID_USER
      fingerprint:  $OCI_FINGERPRINT
      api-key:      "$(cat api-key.pem)"
      namespace:    $OCI_NAMESPACE
      bucket-name:  $OCI_BUCKETNAME
      command:      get
      object-name:  kubeconfig
    - wercker/kubectl@3.9.0:
      raw-args:     --kubeconfig=kubeconfig
      command:      get nodes
    
